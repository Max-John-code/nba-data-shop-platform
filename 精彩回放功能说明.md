# 精彩回放功能说明

## 功能概述
精彩回放功能允许管理员上传和管理NBA比赛的精彩视频片段，用户可以浏览和观看这些精彩回放。

## 数据库设计

### highlight 表结构
- `id`: 主键
- `title`: 标题
- `description`: 描述
- `video_url`: 视频URL（本地存储路径或在线视频地址）
- `cover_image`: 封面图片URL
- `match_date`: 比赛日期
- `teams`: 对阵球队（例如：湖人 vs 勇士）
- `views`: 观看次数
- `duration`: 视频时长（秒）
- `created_at`: 创建时间
- `updated_at`: 更新时间
- `is_active`: 是否启用

## 后端实现

### API 接口

1. **获取精彩回放列表**
   - URL: `GET /api/highlights/`
   - 权限: 所有用户
   - 返回: 精彩回放列表（普通用户只能看到启用的）

2. **获取精彩回放详情**
   - URL: `GET /api/highlights/{id}/`
   - 权限: 所有用户

3. **增加观看次数**
   - URL: `POST /api/highlights/{id}/increment_views/`
   - 权限: 所有用户
   - 功能: 播放视频时自动调用

4. **创建精彩回放**
   - URL: `POST /api/highlights/`
   - 权限: 管理员
   - 参数: title, description, video_url, cover_image, match_date, teams, duration

5. **更新精彩回放**
   - URL: `PUT /api/highlights/{id}/`
   - 权限: 管理员

6. **删除精彩回放**
   - URL: `DELETE /api/highlights/{id}/`
   - 权限: 管理员

## 前端实现

### 用户端页面 (`/pages/highlights/index.vue`)

功能：
- 展示精彩回放列表
- 显示封面图、标题、对阵球队、观看次数
- 点击播放视频（弹窗形式）
- 自动统计观看次数

导航入口：
- 首页导航栏："精彩回放"

### 管理员后台页面 (`/pages/admin/highlights.vue`)

功能：
- 查看所有精彩回放（包括禁用的）
- 添加新的精彩回放
- 编辑现有精彩回放
- 删除精彩回放
- 启用/禁用精彩回放

导航入口：
- 管理后台首页："精彩回放管理"

## 部署步骤

### 1. 数据库初始化

```bash
# 在 MySQL 中执行以下 SQL 文件
mysql -u root -p nba_platform < 创建精彩回放表.sql
mysql -u root -p nba_platform < 插入精彩回放测试数据.sql
```

### 2. 后端部署

```bash
cd nba_backend

# 创建数据库迁移
python manage.py makemigrations highlights

# 执行迁移
python manage.py migrate

# 启动服务器
python manage.py runserver
```

### 3. 前端部署

```bash
cd nba-data-shop-platform

# 安装依赖（如果还没安装）
npm install

# 运行开发服务器
npm run dev:h5
```

## 视频存储方案

### 方案一：本地存储（推荐用于开发测试）
1. 在后端项目创建 `media/videos/` 目录
2. 配置 Django 的 MEDIA_URL 和 MEDIA_ROOT
3. 视频URL格式：`http://localhost:8000/media/videos/filename.mp4`

### 方案二：云存储（推荐用于生产环境）
1. 使用阿里云OSS、腾讯云COS等云存储服务
2. 上传视频到云存储
3. 获取视频的公网访问URL
4. 将URL保存到数据库

## 测试数据说明

测试数据包含6条精彩回放记录：
1. 詹姆斯关键三分绝杀
2. 库里超远三分集锦
3. 字母哥暴力扣篮合集
4. 东契奇三双表演
5. 塔图姆关键时刻连续得分
6. 约基奇精妙传球集锦

注意：测试数据中的视频URL是示例地址，需要替换为实际的视频地址。

## 功能特点

1. **响应式设计**: 适配不同屏幕尺寸
2. **视频播放**: 支持弹窗播放，提供良好的观看体验
3. **观看统计**: 自动记录观看次数
4. **权限控制**: 管理员可以管理所有内容，普通用户只能查看
5. **状态管理**: 支持启用/禁用功能
6. **搜索排序**: 按比赛日期和创建时间排序

## 后续优化建议

1. 添加视频分类（扣篮、三分、助攻等）
2. 添加球员标签功能
3. 支持视频上传功能
4. 添加评论和点赞功能
5. 添加分享功能
6. 优化视频加载性能
7. 添加视频预览功能
